<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kana RPG - Battle Monsters!</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            overflow: hidden;
            position: relative;
            height: 100vh;
            color: white;
        }

        #game-container {
            position: relative;
            width: 100%;
            height: 100vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            align-items: center;
        }

        /* Start Screen */
        #start-screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 5000;
        }

        #start-screen h1 {
            font-size: 64px;
            color: #ff6b6b;
            margin-bottom: 20px;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.5);
        }

        #start-screen p {
            font-size: 24px;
            color: #ffeb3b;
            margin: 10px 0;
            text-align: center;
            max-width: 600px;
        }

        #start-button {
            margin-top: 40px;
            padding: 20px 60px;
            font-size: 32px;
            background: #ff6b6b;
            color: white;
            border: none;
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        }

        #start-button:hover {
            background: #ee5a52;
            transform: scale(1.05);
        }

        /* Top HUD */
        #hud {
            width: 100%;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            z-index: 100;
        }

        #wave-info {
            background: rgba(0, 0, 0, 0.7);
            padding: 15px 25px;
            border-radius: 10px;
            font-size: 24px;
            color: #4ecdc4;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        #score-display {
            background: rgba(0, 0, 0, 0.7);
            padding: 15px 25px;
            border-radius: 10px;
            font-size: 24px;
            color: #ffeb3b;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        /* Battle Area */
        #battle-area {
            flex: 1;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 100%;
            max-width: 1200px;
            position: relative;
        }

        /* Monster */
        #monster-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            animation: monsterFloat 2s ease-in-out infinite;
        }

        @keyframes monsterFloat {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }

        #monster {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            background: rgba(255, 107, 107, 0.3);
            padding: 30px 50px;
            border-radius: 20px;
            border: 4px solid #ff6b6b;
            box-shadow: 0 10px 30px rgba(255, 107, 107, 0.5);
            margin-bottom: 20px;
            transition: all 0.3s;
        }

        #monster-sprite {
            font-size: 140px;
            filter: drop-shadow(0 5px 15px rgba(0, 0, 0, 0.5));
            margin-bottom: 10px;
        }

        #monster-kana {
            font-size: 48px;
            font-weight: bold;
            color: white;
            background: rgba(0, 0, 0, 0.5);
            padding: 8px 20px;
            border-radius: 10px;
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        #monster.attacking {
            animation: attackPulse 0.5s ease-in-out;
        }

        @keyframes attackPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); filter: brightness(1.5); }
        }

        #monster.damaged {
            animation: damageBlink 0.3s ease-in-out;
        }

        @keyframes damageBlink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }

        #monster-health-bar {
            width: 300px;
            height: 30px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 15px;
            overflow: hidden;
            border: 3px solid #ff6b6b;
            margin-bottom: 10px;
        }

        #monster-health-fill {
            height: 100%;
            background: linear-gradient(90deg, #ff6b6b 0%, #ee5a52 100%);
            transition: width 0.3s ease-out;
            box-shadow: 0 0 10px rgba(255, 107, 107, 0.8);
        }

        #monster-name {
            font-size: 20px;
            color: #ff6b6b;
            font-weight: bold;
            margin-bottom: 5px;
        }

        /* Player */
        #player-container {
            position: absolute;
            bottom: 150px;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #player {
            font-size: 80px;
            background: rgba(78, 205, 196, 0.3);
            padding: 30px 40px;
            border-radius: 15px;
            border: 3px solid #4ecdc4;
            box-shadow: 0 8px 20px rgba(78, 205, 196, 0.5);
            margin-bottom: 15px;
        }

        #player.damaged {
            animation: playerDamage 0.5s ease-in-out;
        }

        @keyframes playerDamage {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        #player-health-bar {
            width: 400px;
            height: 35px;
            background: rgba(0, 0, 0, 0.5);
            border-radius: 17px;
            overflow: hidden;
            border: 3px solid #4ecdc4;
        }

        #player-health-fill {
            height: 100%;
            background: linear-gradient(90deg, #4ecdc4 0%, #44a08d 100%);
            transition: width 0.3s ease-out;
            box-shadow: 0 0 10px rgba(78, 205, 196, 0.8);
        }

        #player-health-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 18px;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
        }

        /* Input Area */
        #input-area {
            width: 100%;
            padding: 30px;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            flex-direction: column;
            align-items: center;
            z-index: 100;
        }

        #input-display {
            background: rgba(255, 255, 255, 0.95);
            padding: 20px 50px;
            border-radius: 15px;
            font-size: 42px;
            font-weight: bold;
            color: #333;
            min-width: 400px;
            text-align: center;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            border: 4px solid #4ecdc4;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        #input-hint {
            margin-top: 15px;
            font-size: 18px;
            color: #aaa;
        }

        /* Game Over */
        #game-over {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            color: white;
            padding: 50px 70px;
            border-radius: 20px;
            text-align: center;
            z-index: 4000;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
            border: 3px solid #ff6b6b;
        }

        #game-over h1 {
            font-size: 56px;
            margin-bottom: 20px;
            color: #ff6b6b;
        }

        #game-over p {
            font-size: 24px;
            margin: 15px 0;
        }

        #restart-button {
            margin-top: 30px;
            padding: 15px 40px;
            font-size: 24px;
            background: #ff6b6b;
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
        }

        #restart-button:hover {
            background: #ee5a52;
            transform: scale(1.05);
        }

        /* Damage Numbers */
        .damage-number {
            position: absolute;
            font-size: 36px;
            font-weight: bold;
            color: #ff6b6b;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
            animation: damageFloat 1s ease-out forwards;
            pointer-events: none;
            z-index: 1000;
        }

        @keyframes damageFloat {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(-100px) scale(1.5);
            }
        }

        .heal-number {
            color: #4ecdc4;
        }

        /* Victory Banner */
        .victory-banner {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            font-size: 72px;
            font-weight: bold;
            color: #ffeb3b;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.8);
            animation: victoryPop 0.5s ease-out forwards;
            z-index: 2000;
            pointer-events: none;
        }

        @keyframes victoryPop {
            0% { transform: translate(-50%, -50%) scale(0); }
            50% { transform: translate(-50%, -50%) scale(1.2); }
            100% { transform: translate(-50%, -50%) scale(0); }
        }
    </style>
</head>
<body>
    <div id="game-container">
        <div id="start-screen">
            <h1>🗡️ Kana RPG Battle 🗡️</h1>
            <p>Face waves of kana monsters!</p>
            <p>Each monster shows a kana character - type its romaji to defeat it!</p>
            <p>Monsters attack continuously until defeated!</p>
            <p>Can you survive the endless waves?</p>
            <button id="start-button">Start Battle</button>
        </div>

        <div id="hud">
            <div id="wave-info">Wave: <span id="wave-number">1</span></div>
            <div id="score-display">Score: <span id="score">0</span></div>
        </div>

        <div id="battle-area">
            <div id="monster-container">
                <div id="monster-name">Kana Monster</div>
                <div id="monster-health-bar">
                    <div id="monster-health-fill"></div>
                </div>
                <div id="monster">
                    <div id="monster-sprite">👹</div>
                    <div id="monster-kana">あ</div>
                </div>
            </div>

            <div id="player-container">
                <div id="player">🗡️</div>
                <div id="player-health-bar">
                    <div id="player-health-fill"></div>
                    <div id="player-health-text"><span id="player-hp">100</span> / <span id="player-max-hp">100</span></div>
                </div>
            </div>
        </div>

        <div id="input-area">
            <div id="input-display"></div>
            <div id="input-hint">Type the romaji of the kana character to attack!</div>
        </div>

        <div id="game-over">
            <h1>Game Over!</h1>
            <p>You survived <span id="final-waves">0</span> waves!</p>
            <p>Final Score: <span id="final-score">0</span></p>
            <button id="restart-button">Try Again</button>
        </div>
    </div>

    <script>
        // Kana to Romaji mapping (Hiragana)
        const hiraganaMap = {
            'あ': 'a', 'い': 'i', 'う': 'u', 'え': 'e', 'お': 'o',
            'か': 'ka', 'き': 'ki', 'く': 'ku', 'け': 'ke', 'こ': 'ko',
            'さ': 'sa', 'し': 'shi', 'す': 'su', 'せ': 'se', 'そ': 'so',
            'た': 'ta', 'ち': 'chi', 'つ': 'tsu', 'て': 'te', 'と': 'to',
            'な': 'na', 'に': 'ni', 'ぬ': 'nu', 'ね': 'ne', 'の': 'no',
            'は': 'ha', 'ひ': 'hi', 'ふ': 'fu', 'へ': 'he', 'ほ': 'ho',
            'ま': 'ma', 'み': 'mi', 'む': 'mu', 'め': 'me', 'も': 'mo',
            'や': 'ya', 'ゆ': 'yu', 'よ': 'yo',
            'ら': 'ra', 'り': 'ri', 'る': 'ru', 'れ': 're', 'ろ': 'ro',
            'わ': 'wa', 'を': 'wo', 'ん': 'n',
            'が': 'ga', 'ぎ': 'gi', 'ぐ': 'gu', 'げ': 'ge', 'ご': 'go',
            'ざ': 'za', 'じ': 'ji', 'ず': 'zu', 'ぜ': 'ze', 'ぞ': 'zo',
            'だ': 'da', 'ぢ': 'ji', 'づ': 'zu', 'で': 'de', 'ど': 'do',
            'ば': 'ba', 'び': 'bi', 'ぶ': 'bu', 'べ': 'be', 'ぼ': 'bo',
            'ぱ': 'pa', 'ぴ': 'pi', 'ぷ': 'pu', 'ぺ': 'pe', 'ぽ': 'po'
        };

        // Kana to Romaji mapping (Katakana)
        const katakanaMap = {
            'ア': 'a', 'イ': 'i', 'ウ': 'u', 'エ': 'e', 'オ': 'o',
            'カ': 'ka', 'キ': 'ki', 'ク': 'ku', 'ケ': 'ke', 'コ': 'ko',
            'サ': 'sa', 'シ': 'shi', 'ス': 'su', 'セ': 'se', 'ソ': 'so',
            'タ': 'ta', 'チ': 'chi', 'ツ': 'tsu', 'テ': 'te', 'ト': 'to',
            'ナ': 'na', 'ニ': 'ni', 'ヌ': 'nu', 'ネ': 'ne', 'ノ': 'no',
            'ハ': 'ha', 'ヒ': 'hi', 'フ': 'fu', 'ヘ': 'he', 'ホ': 'ho',
            'マ': 'ma', 'ミ': 'mi', 'ム': 'mu', 'メ': 'me', 'モ': 'mo',
            'ヤ': 'ya', 'ユ': 'yu', 'ヨ': 'yo',
            'ラ': 'ra', 'リ': 'ri', 'ル': 'ru', 'レ': 're', 'ロ': 'ro',
            'ワ': 'wa', 'ヲ': 'wo', 'ン': 'n',
            'ガ': 'ga', 'ギ': 'gi', 'グ': 'gu', 'ゲ': 'ge', 'ゴ': 'go',
            'ザ': 'za', 'ジ': 'ji', 'ズ': 'zu', 'ゼ': 'ze', 'ゾ': 'zo',
            'ダ': 'da', 'ヂ': 'ji', 'ヅ': 'zu', 'デ': 'de', 'ド': 'do',
            'バ': 'ba', 'ビ': 'bi', 'ブ': 'bu', 'ベ': 'be', 'ボ': 'bo',
            'パ': 'pa', 'ピ': 'pi', 'プ': 'pu', 'ペ': 'pe', 'ポ': 'po'
        };

        // Combine both kana sets
        const allKanaMap = {...hiraganaMap, ...katakanaMap};

        // Game state
        let gameRunning = false;
        let currentInput = '';
        let score = 0;
        let wave = 1;
        let playerMaxHP = 100;
        let playerHP = 100;
        let monsterHP = 100;
        let monsterMaxHP = 100;
        let currentMonster = null;
        let damageInterval = null;
        let monstersInWave = 3;
        let monstersDefeated = 0;

        // Monster sprites array
        const monsterSprites = [
            '👹', '👺', '👻', '💀', '👾', '🐉', '🐲',
            '🦖', '🦕', '🐍', '🦂', '🕷️', '🦇', '🐙',
            '🦑', '🐊', '🦈', '👿', '😈', '🤖', '👽'
        ];

        // DOM elements
        const startScreen = document.getElementById('start-screen');
        const startButton = document.getElementById('start-button');
        const inputDisplay = document.getElementById('input-display');
        const monsterElement = document.getElementById('monster');
        const monsterSpriteElement = document.getElementById('monster-sprite');
        const monsterKanaElement = document.getElementById('monster-kana');
        const monsterNameElement = document.getElementById('monster-name');
        const monsterHealthFill = document.getElementById('monster-health-fill');
        const playerHealthFill = document.getElementById('player-health-fill');
        const playerHPText = document.getElementById('player-hp');
        const playerMaxHPText = document.getElementById('player-max-hp');
        const waveNumberElement = document.getElementById('wave-number');
        const scoreElement = document.getElementById('score');
        const gameOverScreen = document.getElementById('game-over');
        const finalScoreElement = document.getElementById('final-score');
        const finalWavesElement = document.getElementById('final-waves');
        const restartButton = document.getElementById('restart-button');
        const playerElement = document.getElementById('player');
        const monsterContainer = document.getElementById('monster-container');

        // Get random kana
        function getRandomKana() {
            const kanaList = Object.keys(allKanaMap);
            const kanaChar = kanaList[Math.floor(Math.random() * kanaList.length)];
            return {char: kanaChar, romaji: allKanaMap[kanaChar]};
        }

        // Spawn new monster
        function spawnMonster() {
            currentMonster = getRandomKana();

            // Select random monster sprite
            const randomSprite = monsterSprites[Math.floor(Math.random() * monsterSprites.length)];
            monsterSpriteElement.textContent = randomSprite;
            monsterKanaElement.textContent = currentMonster.char;

            // Generate creative monster names
            const monsterTypes = ['Demon', 'Beast', 'Shadow', 'Wraith', 'Fiend', 'Horror', 'Nightmare', 'Terror'];
            const randomType = monsterTypes[Math.floor(Math.random() * monsterTypes.length)];
            monsterNameElement.textContent = `${randomType} Lv.${wave}`;

            // Monster HP scales with wave
            monsterMaxHP = 100 + (wave - 1) * 20;
            monsterHP = monsterMaxHP;
            updateMonsterHealth();

            // Start monster damage over time
            startMonsterAttacks();
        }

        // Start monster attacking player
        function startMonsterAttacks() {
            if (damageInterval) clearInterval(damageInterval);

            damageInterval = setInterval(() => {
                if (!gameRunning) return;

                // Monster deals damage based on wave (increases with difficulty)
                const damage = 5 + Math.floor(wave / 2);
                playerHP = Math.max(0, playerHP - damage);
                updatePlayerHealth();

                // Show damage animation
                monsterElement.classList.add('attacking');
                playerElement.classList.add('damaged');
                setTimeout(() => {
                    monsterElement.classList.remove('attacking');
                    playerElement.classList.remove('damaged');
                }, 500);

                // Show damage number
                showDamageNumber(damage, false);

                // Check if player died
                if (playerHP <= 0) {
                    gameOver();
                }
            }, 2000); // Monster attacks every 2 seconds
        }

        // Stop monster attacks
        function stopMonsterAttacks() {
            if (damageInterval) {
                clearInterval(damageInterval);
                damageInterval = null;
            }
        }

        // Show floating damage numbers
        function showDamageNumber(amount, isHeal = false) {
            const damageNum = document.createElement('div');
            damageNum.className = 'damage-number' + (isHeal ? ' heal-number' : '');
            damageNum.textContent = (isHeal ? '+' : '-') + amount;

            // Position near player
            damageNum.style.left = '50%';
            damageNum.style.top = '60%';

            document.getElementById('game-container').appendChild(damageNum);

            setTimeout(() => damageNum.remove(), 1000);
        }

        // Update health bars
        function updatePlayerHealth() {
            const percentage = (playerHP / playerMaxHP) * 100;
            playerHealthFill.style.width = percentage + '%';
            playerHPText.textContent = Math.max(0, playerHP);
        }

        function updateMonsterHealth() {
            const percentage = (monsterHP / monsterMaxHP) * 100;
            monsterHealthFill.style.width = percentage + '%';
        }

        // Check input
        function checkInput() {
            if (!currentMonster) return;

            if (currentInput.toLowerCase() === currentMonster.romaji) {
                // Correct! Defeat monster
                defeatMonster();
            } else if (currentMonster.romaji.startsWith(currentInput.toLowerCase())) {
                // Correct so far, keep going
                return;
            } else {
                // Wrong input, reset
                currentInput = '';
                inputDisplay.textContent = '';
            }
        }

        // Defeat monster
        function defeatMonster() {
            stopMonsterAttacks();

            // Animation
            monsterElement.classList.add('damaged');

            // Award points
            const points = 100 * wave;
            score += points;
            scoreElement.textContent = score;

            // Show victory banner
            const banner = document.createElement('div');
            banner.className = 'victory-banner';
            banner.textContent = '+' + points;
            document.getElementById('game-container').appendChild(banner);
            setTimeout(() => banner.remove(), 500);

            // Reset input
            currentInput = '';
            inputDisplay.textContent = '';

            monstersDefeated++;

            // Check if wave is complete
            if (monstersDefeated >= monstersInWave) {
                // Next wave
                setTimeout(() => {
                    nextWave();
                }, 1000);
            } else {
                // Spawn next monster in wave
                setTimeout(() => {
                    monsterElement.classList.remove('damaged');
                    spawnMonster();
                }, 1000);
            }
        }

        // Next wave
        function nextWave() {
            wave++;
            monstersDefeated = 0;
            monstersInWave = 3 + Math.floor(wave / 3); // More monsters each wave
            waveNumberElement.textContent = wave;

            // Heal player slightly between waves
            const heal = 20;
            playerHP = Math.min(playerMaxHP, playerHP + heal);
            updatePlayerHealth();

            monsterElement.classList.remove('damaged');
            spawnMonster();
        }

        // Game over
        function gameOver() {
            gameRunning = false;
            stopMonsterAttacks();
            finalScoreElement.textContent = score;
            finalWavesElement.textContent = wave;
            gameOverScreen.style.display = 'block';
        }

        // Start game
        function startGame() {
            // Reset state
            gameRunning = true;
            score = 0;
            wave = 1;
            monstersDefeated = 0;
            monstersInWave = 3;
            playerHP = playerMaxHP;
            currentInput = '';

            // Reset UI
            scoreElement.textContent = score;
            waveNumberElement.textContent = wave;
            inputDisplay.textContent = '';
            startScreen.style.display = 'none';
            gameOverScreen.style.display = 'none';
            updatePlayerHealth();

            // Spawn first monster
            spawnMonster();
        }

        // Keyboard input
        document.addEventListener('keydown', (e) => {
            if (!gameRunning) return;

            const key = e.key.toLowerCase();

            // Only accept letters
            if (key.length === 1 && key.match(/[a-z]/)) {
                currentInput += key;
                inputDisplay.textContent = currentInput;
                checkInput();
            }

            // Backspace
            if (e.key === 'Backspace') {
                currentInput = currentInput.slice(0, -1);
                inputDisplay.textContent = currentInput;
            }
        });

        // Event listeners
        startButton.addEventListener('click', startGame);
        restartButton.addEventListener('click', startGame);

        window.focus();
    </script>
</body>
</html>
